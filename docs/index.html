<!DOCTYPE html>
<html>
<head>
  
  <title>Psychic Bassoon</title>

<style type="text/css">
  body {
    font-family: "droid mono", "courier new", "monospace";
  }
</style>
  
<script type="text/javascript">
function generateOnePassphrase(n) {
  var p = "";
  
  // base58 is [a-zA-Z0-9] except for
  // 0 (zero), O (capital o), I (capital i) and l (lower case L)
  var re = /[a-km-np-zA-HJ-NP-Z1-9]/;
  while (p.length < n) {
    var array = new Uint8Array(1);
    window.crypto.getRandomValues(array);
    const c = String.fromCharCode.apply(null, array);
    if (c.match(re)) {
      p += c;
    }
  }
  return p;
}

var generatePassphrases = function() {
  var e = document.getElementById("passphrases");
  var passphrases = [];
  for (i = 0; i < 32; i++) {
    passphrases.push("<div>" + generateOnePassphrase(22) + "</div>");
  }
  e.innerHTML = passphrases.join("\n");
};

window.addEventListener("load", generatePassphrases);
</script>

</head>

<h1>Psychic Bassoon: a whole bunch of passphrases generated by your browser's
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues">crypto.getRandomValues()</a> function</h1>
  
  <p>All passphrases are generated in JavaScript by your own browser. Unless you have malware on your system,
    they'll never leave this page. Suspicious? Good! <a href="https://github.com/sowbug/psychic-bassoon">Read the source</a>
    for yourself, confirm it's safe, and download your own local copy.</p>

  <p>Each passphrase consists of <a href="https://en.wikipedia.org/wiki/Base58">Base58 characters</a> and is 22 characters
    long. That should get you over 128 bits of entropy (58 log base 2 = about 5.85, 5.85 x 22 = 128.7), which is more than
    enough to withstand offline brute-forcing.</p>

<div id="passphrases"></div>

</html>
