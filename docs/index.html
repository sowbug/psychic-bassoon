<!DOCTYPE html>
<html>
<head>

  <title>Psychic Bassoon</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

<style type="text/css">
  body, button {
    font-family: helvetica;
  }
  #passphrases {
    font-family: courier;
  }
</style>

<script type="text/javascript">

function generateOnePassphrase(n) {
  // base58 is [a-zA-Z0-9] except for
  // 0 (zero), O (capital o), I (capital i) and l (lower case L)
  const re = /[a-km-np-zA-HJ-NP-Z1-9]/;

  const a = new Uint8Array(32);
  var p = "";

  while (p.length < n) {
    window.crypto.getRandomValues(a);
    var s = String.fromCharCode.apply(null, a);
    var i = 0;
    while (p.length < n && i < s.length) {
      var c = s[i++];
      if (c.match(re)) {
	p += c;
      }
    }
  }

  return p;
}

const DESIRED_BITS_OF_ENTROPY = 128;
const BITS_OF_ENTROPY_IN_BASE58 = Math.log(58) / Math.log(2);
const PASSPHRASE_LEN = Math.ceil(DESIRED_BITS_OF_ENTROPY / BITS_OF_ENTROPY_IN_BASE58);
function generatePassphrases() {
  var e = document.getElementById("passphrases");
  var passphrases = [];
  for (i = 0; i < 8; i++) {
    passphrases.push("<div>" +
                     generateOnePassphrase(PASSPHRASE_LEN) + " " +
                     generateOnePassphrase(PASSPHRASE_LEN) + " " +
                     generateOnePassphrase(PASSPHRASE_LEN) + " " +
                     generateOnePassphrase(PASSPHRASE_LEN) +
                     "</div>");
  }
  e.innerHTML = passphrases.join("\n");
}

var onload = function() {
  var e = document.getElementById("more");
  e.addEventListener("click", generatePassphrases);
  generatePassphrases();
  e.style.display = "block";
};

window.addEventListener("load", onload);
</script>

</head>

<h1>Psychic Bassoon: a whole bunch of passphrases generated by your browser's
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues">crypto.getRandomValues()</a> function</h1>

  <p>All passphrases on this page are generated in JavaScript by your own browser. Unless you have malware on your system,
    they'll never leave this page. Sound suspicious to you? Good! <a href="https://github.com/sowbug/psychic-bassoon">Read
    the source</a> for yourself, satisfy yourself it's safe, and if you're extra-paranoid, download your own local copy.</p>

  <p>Each of the passphrases below consists of <a href="https://en.wikipedia.org/wiki/Base58">Base58 characters</a> and is
    22 characters long. That should get you over 128 bits of entropy (58 log base 2 = about 5.85, 5.85 x 22 = 128.7),
    which is <a href="https://en.wikipedia.org/wiki/Key_size#Symmetric_algorithm_key_lengths">more than enough</a> for any
    practical purpose.</p>

<div id="passphrases"></div>
<p>
  <button id="more" style="display:none">I'm Feeling Lucky</button>
</p>

</html>
