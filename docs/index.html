<!DOCTYPE html>
<html>
<head>

  <title>Psychic Bassoon</title>

<style type="text/css">
  body, button {
    font-family: helvetica;
  }
  #passphrases {
    font-family: courier;
  }
</style>

<script type="text/javascript">

function generateOnePassphrase(n) {
  var p = "";

  // base58 is [a-zA-Z0-9] except for
  // 0 (zero), O (capital o), I (capital i) and l (lower case L)
  var re = /[a-km-np-zA-HJ-NP-Z1-9]/;

  while (p.length < n) {
    var array = new Uint8Array(1);
    window.crypto.getRandomValues(array);
    const c = String.fromCharCode.apply(null, array);
    if (c.match(re)) {
      p += c;
    }
  }

  return p;
}

function generatePassphrases() {
  var e = document.getElementById("passphrases");
  var passphrases = [];
  for (i = 0; i < 8; i++) {
    passphrases.push("<div>" +
                     generateOnePassphrase(22) + " " +
                     generateOnePassphrase(22) + " " +
                     generateOnePassphrase(22) + " " +
                     generateOnePassphrase(22) +
                     "</div>");
  }
  e.innerHTML = passphrases.join("\n");
}

var onload = function() {
  var e = document.getElementById("more");
  e.addEventListener("click", generatePassphrases);
  generatePassphrases();
  e.style.display = "block";
};

window.addEventListener("load", onload);
</script>

</head>

<h1>Psychic Bassoon: a whole bunch of passphrases generated by your browser's
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues">crypto.getRandomValues()</a> function</h1>

  <p>All passphrases on this page are generated in JavaScript by your own browser. Unless you have malware on your system,
    they'll never leave this page. Sound suspicious to you? Good! <a href="https://github.com/sowbug/psychic-bassoon">Read
    the source</a> for yourself, satisfy yourself it's safe, and if you're extra-paranoid, download your own local copy.</p>

  <p>Each of the passphrases below consists of <a href="https://en.wikipedia.org/wiki/Base58">Base58 characters</a> and is
    22 characters long. That should get you over 128 bits of entropy (58 log base 2 = about 5.85, 5.85 x 22 = 128.7),
    which is <a href="https://en.wikipedia.org/wiki/Key_size#Symmetric_algorithm_key_lengths">more than enough</a> for any
    practical purpose.</p>

<div id="passphrases"></div>
<p>
  <button id="more" style="display:none">I'm Feeling Lucky</button>
</p>

</html>
